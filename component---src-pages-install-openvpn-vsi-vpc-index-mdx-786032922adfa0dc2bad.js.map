{"version":3,"sources":["webpack:///./src/pages/install/openvpn-vsi-vpc/index.mdx"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-install-openvpn-vsi-vpc-index-mdx-786032922adfa0dc2bad.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/ibm-enterprise-runbooks/ibm-enterprise-runbooks/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1>{`Use OpenVPN to access virtual server instances running in a virtual private cloud`}</h1>\n    <p>{`Virtual Private Cloud (VPC) come with an additional layer of security as your workload can be completely hidden from the public Internet. But there are times when you will want to get into this private network. A common practice is to use a bastion host to jump into your VPC from your local machine as example. Another option is to install a VPN software inside your VPC to extend the secure VPC network to your local network.`}</p>\n    <p>{`OpenVPN is a popular VPN software solution that can be easily installed on a server and offer a simple way to reach all the servers in your VPC from your local machine.`}</p>\n    <p>{`This repo shows how to deploy OpenVPN inside a VPC using Terraform and Ansible.`}</p>\n    <p>{`  `}<span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1152px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"62.84722222222222%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACE0lEQVQ4y42TSY/TQBCF84+ZIz+EO6ecRkjDETQcolFgGDIzibJ6ae9LYjtp2/Eax3lTzgIRhIGWnsott76qV13dwtna7Xb7mBYV3t1McD+QIao2/DCHx7P/UusScLMFFMOFMO4jXPnYViVp86rq7QbVpkCrgZxAp5iXNfxliNsHhmfBQUEZ0qImneJvovNJvkWcFr8qPAc3lqN1hoHC0R8riDhHkqSvap1kWMVkua5rNDpfWbmFzxNkWY5Ot4Nu7xtUXYPEZMgqAyPJykGHbxmmZSFc52hdvblCu93eg8pNdbRMwJCAaYXP4zu8/3GNwfQ7psYQ+lKB4jFoPoMRMOgktpCgmNoB+PHmGo9PPagRMHQS5HkOHiWw5gE8n2MoTyCbfYw+vIU4uYXKF1hEOoENTB0damDACTUwi4AxAXv3GUwzx520wJeRe7BMPfT5mg5kEA0ZzkrG48MndEcDjB0TXqxDcDV0BAUjAjlcBTOPwKeeB1WJwVdzuLb9s4cBWY7IgmQSMDJgxQs8Ux91X4NLe2Opo68xqJ4Gm59VGMccRZH+cSkBPwBFArpUkeqp+CoIYASYxwRc6ZjaClRKYDeWTz28NDanW24yipoMwRAILEK2xH0UDPG4lyCRZvqMHoKOVZRfHuwGGMYpirKi+cppzrL9nP1Nzf+EhjrNy8tPrxmbibakSgLK3sR/qzk30wK8AGS20LSoHhB9AAAAAElFTkSuQmCC')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"architecture.png\",\n          \"title\": \"architecture.png\",\n          \"src\": \"/ibm-enterprise-runbooks/static/0220faf1044e1e967f38061700d5ba2c/3cbba/architecture.png\",\n          \"srcSet\": [\"/ibm-enterprise-runbooks/static/0220faf1044e1e967f38061700d5ba2c/7fc1e/architecture.png 288w\", \"/ibm-enterprise-runbooks/static/0220faf1044e1e967f38061700d5ba2c/a5df1/architecture.png 576w\", \"/ibm-enterprise-runbooks/static/0220faf1044e1e967f38061700d5ba2c/3cbba/architecture.png 1152w\", \"/ibm-enterprise-runbooks/static/0220faf1044e1e967f38061700d5ba2c/eb0e7/architecture.png 1314w\"],\n          \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span>{`\n`}<span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"800px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"171.18055555555557%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAiCAIAAADQyG7qAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEh0lEQVRIx31VW28bRRjdHwBCoJKLHe96Z2bHe/Oub3uLs3Zsx8FO00QqhapEAqSAQJQEIRpAVDS9pX1AqBKPPPNIfwA8ISrBH0CCKnnrC5VQS6h44IHCmV13ExoX6Wg0szPnu3/fSlHcGiwP/TiuhFGGajTb7PXC+Q7QmItrs83syvGDqNNdOL7sBqG0sHzig0/O4wUOQNnzATx68ZW1V9ffeGtjc3FltewHlWg2Iwft+ffObXlxSzJrdaveMKs1o1KFwtluL2i1w/Y8dOLabnjp7WEY1ZobBFatLhWYNkMZkCeUWbbr+Xat7jQ81w9KjptPro4Cj0GUFF4ihplC1Q0cAVnjADb4Mha4EmTImFKK0yoRa1HNqQRrKiKT8hhASZVLRqXSGy41EcDhUveFQau30B0M5UTwWIBWDULdceGgpLtuu98PW+3WQj/uLfhz8Vy3l4k/CphWCyPVMKFJmqFCmBApwEDDMQvBkxyekJWULKyHPCDdIMLTyTrWYaBY0hEgQdbsMmxu9xdhcxC34HxqueP5aT6OAvzJVDM1rcZsE3xwEAlUSDWMIAU18KSYHZBhAy873K2jJEScVJLVQJYwoJgg3auZ2QiM63lL855Tb3DbkXWbmbZmYbUyaKalGgJacuR2GaEZBaxA6ZdnVMekz8msXWMyYzki1kICbCaKrGwyx0Ig8VikZhTt1I1v3qbfnaVfr9NfPqRfvUartvZMQctTbZpok6qmcu3mOj0ds2flVOgjsqyVYMz3G+zhNfLnFXL/Inl4Tb3xsjaMjM1hab2vn2obP25SXK11jBy3uHXIbD9UdZvf2qAPrpC7F8hv2wL7l+jdbfbzR/SnLXrvEvv9Etm/TF7vasfUEtEPBezkykwrVn54h/11mdy/QPa3U6h/bKsPLo729z4lf18l5wb06Rkmpz4XErPPnCq8/6b87Ra78xnZ3WF71+nedba3w3avMhx3k83tHfbr5/SLdZ7nllM1DceeoWpncSBx24hi3/GsUpkajpZCLydwEpSTj67GLU0RtcnVUmlKSTQrXKemrZRMhRuTCgfyRMv9FyLmRSRFeIsiQVGi5wXZcCvdwaC/NHT81umT+UFfnpBR/Y8qkQly2ebnl1U/DHrD453Fxag9j96a7y9K1DDr0WwtDKeJufZSbnW5cKzAFe2gkpFtTdeWAqo7DroAMwDGTxTkUYWJ0aMSFBN0wmxZe7wNCoxPEZ6+BA4agyVdBeVYmWUlJZkqZGgYfKx4PrTVghBvzEoVIuD2iIxyCZM2bnY66LB0qggyoaWyE8RxPYpwBR3FJFrZJINoYTZClzbg0b4d9aBupATYhXDICfKESRj0GH1ivo+bG9ncGx1RW0U2WSRTRCRCDINGswkbcskYyN6NGSAMCWcfrxo3361HFQq+VEjmRjrWUAPZ3+AoM8+4xuQ7N3r/3Nq6eEJ5qsBFnr3mHIYWZhh+UVa1hgIaq3+kecW4ebYWuRR9LqKNNFT8ANNPZvz/LYfPzxcxWITPCudSozmHckkn9pM4h4Fog5ZTVW8u/hcJv4lc1jU/yQAAAABJRU5ErkJggg==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"openvpn.png\",\n          \"title\": \"openvpn.png\",\n          \"src\": \"/ibm-enterprise-runbooks/static/a97197217b0fafbe560b53cbca91c74f/acfc1/openvpn.png\",\n          \"srcSet\": [\"/ibm-enterprise-runbooks/static/a97197217b0fafbe560b53cbca91c74f/7fc1e/openvpn.png 288w\", \"/ibm-enterprise-runbooks/static/a97197217b0fafbe560b53cbca91c74f/a5df1/openvpn.png 576w\", \"/ibm-enterprise-runbooks/static/a97197217b0fafbe560b53cbca91c74f/acfc1/openvpn.png 800w\"],\n          \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <h2>{`Deploy all resources`}</h2>\n    <ol>\n      <li parentName=\"ol\">{`Copy `}<inlineCode parentName=\"li\">{`terraform.tfvars.template`}</inlineCode>{` to `}<inlineCode parentName=\"li\">{`terraform.tfvars`}</inlineCode>{`:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-sh\"\n          }}>{`cp terraform.tfvars.template terraform.tfvars\n`}</code></pre></li>\n      <li parentName=\"ol\">{`Edit `}<inlineCode parentName=\"li\">{`terraform.tfvars`}</inlineCode>{` to match your environment.`}</li>\n      <li parentName=\"ol\">{`Use the `}<a parentName=\"li\" {...{\n          \"href\": \"https://github.com/l2fprod/ibmcloud-ci\"\n        }}>{`following Docker image`}</a>{` to run the deployment scripts. It has all required tools preinstalled.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`On Linux terminal:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`docker run -it --volume $PWD:/root/mnt/home --workdir /root/mnt/home l2fprod/ibmcloud-ci\n`}</code></pre></li>\n          <li parentName=\"ul\">{`On Windows command prompt:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`docker run -it --volume %CD%:/root/mnt/home --workdir /root/mnt/home l2fprod/ibmcloud-ci\n`}</code></pre>{`You can also try with your own environment. Prereqs are: tfswitch, terraform, ansible, ssh.`}</li>\n        </ul></li>\n      <li parentName=\"ol\">{`Run `}<inlineCode parentName=\"li\">{`tfswitch`}</inlineCode>{` to point to the right Terraform version for this solution:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`tfswitch\n`}</code></pre></li>\n      <li parentName=\"ol\">{`Deploy all resources:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-sh\"\n          }}>{`terraform init\nterraform apply\n`}</code></pre></li>\n    </ol>\n    <h2>{`Install OpenVPN on the bastion`}</h2>\n    <ol>\n      <li parentName=\"ol\">{`Change to ansible directory:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`cd ansible\n`}</code></pre></li>\n      <li parentName=\"ol\">{`Install ansible dependencies`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`ansible-galaxy install -r requirements.yml\n`}</code></pre></li>\n      <li parentName=\"ol\">{`To confirm ansible configuration, ping all hosts`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`ansible all -m ping -i inventory -v\n`}</code></pre></li>\n      <li parentName=\"ol\">{`Install OpenVPN on the bastion`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`ansible-playbook -i inventory playbook-openvpn.yml\n`}</code></pre></li>\n    </ol>\n    <h2>{`Connect to OpenVPN`}</h2>\n    <p>{`To connect to the VPN, use `}<em parentName=\"p\">{`OpenVPN Connects`}</em>{` with the configuration generated in `}<inlineCode parentName=\"p\">{`ansible/client-config/mymachine`}</inlineCode>{`:`}</p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://openvpn.net/client-connect-vpn-for-windows/\"\n        }}>{`https://openvpn.net/client-connect-vpn-for-windows/`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://openvpn.net/client-connect-vpn-for-mac-os/\"\n        }}>{`https://openvpn.net/client-connect-vpn-for-mac-os/`}</a></li>\n    </ul>\n    <p>{`or from a command line`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`openvpn --setenv FORWARD_COMPATIBLE 1 --daemon --config ./client-config/mymachine/*-bastion.ovpn\n`}</code></pre>\n    <p>{`To view routes on macOS, use `}<inlineCode parentName=\"p\">{`netstat -nr`}</inlineCode>{`. On Linux and Windows `}<inlineCode parentName=\"p\">{`netstat -ar`}</inlineCode>{`.`}</p>\n    <h2>{`Test the OpenVPN connection`}</h2>\n    <p>{`From the Docker container, ping one VPC server instance directly from your local machine:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`ping $(terraform output -json | jq -r '.instance_ips.value[0]')\n`}</code></pre>\n    <p>{`or a COS direct endpoint:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`ping s3.direct.us.cloud-object-storage.appdomain.cloud\n`}</code></pre>\n    <p>{`or a service private endpoint:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`ping api.private.us-south.speech-to-text.watson.cloud.ibm.com\n`}</code></pre>\n    <p>{`If you stop the VPN connection, all these ping would fail.`}</p>\n    <h2>{`Destroy all configuration`}</h2>\n    <ol>\n      <li parentName=\"ol\">{`To destroy the environment, from the Docker container use:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-sh\"\n          }}>{`terraform destroy\n`}</code></pre></li>\n    </ol>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}