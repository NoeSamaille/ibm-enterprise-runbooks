{"version":3,"sources":["webpack:///./src/pages/ibmcloud/openvpn-vsi-vpc/index.mdx"],"names":["name","_frontmatter","PageDescription","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-ibmcloud-openvpn-vsi-vpc-index-mdx-f39bed115ff4093c3b36.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/ibm-enterprise-runbooks/ibm-enterprise-runbooks/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nimport Globals from 'gatsby-theme-carbon/src/templates/Globals';\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst PageDescription = makeShortcode(\"PageDescription\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <PageDescription mdxType=\"PageDescription\">\n    </PageDescription>\n    <h2><strong parentName=\"h2\">{`Use OpenVPN to access virtual server instances running in a virtual private cloud`}</strong></h2>\n    <p>{`Virtual Private Cloud (VPC) come with an additional layer of security as your workload can be completely hidden from the public Internet. But there are times when you will want to get into this private network. A common practice is to use a bastion host to jump into your VPC from your local machine as example. Another option is to install a VPN software inside your VPC to extend the secure VPC network to your local network.`}</p>\n    <p>{`OpenVPN is a popular VPN software solution that can be easily installed on a server and offer a simple way to reach all the servers in your VPC from your local machine.`}</p>\n    <p>{`This repo shows how to deploy OpenVPN inside a VPC using Terraform and Ansible.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"954px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"63.888888888888886%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACuUlEQVQ4y42T20vTYRjHRzfRAcvzNt35N9cmLVL/hu4kQrSTZdC1Bd4H3lSEYYEE0kUXkZRm10UYJeVhnrKoJTVduoPHnHNzm3O/fXp/28JUgh748ty8fN7n8H1UcjpN+i/JslB6r1IpGSXmAwE6Otq52XaXtvv36ejs5E77PVpv3ebJs25UCkSJP/lfkZazwI+Tk+isVrQWCXtVNZXVNWjMFo6otdQ3XsoC/8ASWzLeXxtEEkmh1A6FY5soyMGRMTQmM1LlcXRSBSV6I2UWK0cFsLauHpUsfpZzv8dT0Dc+hX9+gXgyxYYAb2wmszmeYFO86R8awWJ34DhZRZlZQm0wZfKRUg0Xmq6g2t3SF98Kbu8CMVFROBJnPRITOSbyBlHxYf/gMHqbHaPDiVmAtUYjaqOZA/lFNFwULft8c3z79jUDS4rBL4RivPv0gYmvw3gD08wEZ/AGp/H4PIQTMm8HXJw8buWE00ahXmK/2ixmKJFXXEJD42VUXs8sbwYmGV1JEI3F8S2GcfvduFwv+Bz8wffVOYaCXjyLHtYF8NV7Fy2nNIRadTw4Z+BGrYGHjSYKSkuzwGhEZs4fYzEUEhWmCaxE8K/MMi6qmhCg6dVZhvwzTC95WIvJDIwP01yrpe+6gZfNBvpb9Dy6aiK/tFgALylLSYn5bWVa3hIeDK5G8S74cItW3QGlsp9MzXv5HphhLS7zfngUo71SzNDIYY2RQ2o9VpuE1mTJLiVjm9xiMsBQlOW1bS3ltLi6Tji5vWXJIVGiM2A+ZsfhdHK4REvd+Ys7fajkeFImvrVXin2UGBmbyPhPY5Iy29VX2CiTbJTr1NSfrf//S1FGo4RrdJQCbTn5Gi0HC4qEXQrZl1fImZpirjWdFjPcfcv/UCrn06XlZbp7e3na85wucbsZdffw+EkXr/v6+A0gkyW1uSjjrgAAAABJRU5ErkJggg==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"openvpn.png\",\n          \"title\": \"openvpn.png\",\n          \"src\": \"/ibm-enterprise-runbooks/static/5d832f928bf5fae20794ba1b6bc596ab/38d0b/vpc-vsi.png\",\n          \"srcSet\": [\"/ibm-enterprise-runbooks/static/5d832f928bf5fae20794ba1b6bc596ab/7fc1e/vpc-vsi.png 288w\", \"/ibm-enterprise-runbooks/static/5d832f928bf5fae20794ba1b6bc596ab/a5df1/vpc-vsi.png 576w\", \"/ibm-enterprise-runbooks/static/5d832f928bf5fae20794ba1b6bc596ab/38d0b/vpc-vsi.png 954w\"],\n          \"sizes\": \"(max-width: 954px) 100vw, 954px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span>{` `}</p>\n    <h3><strong parentName=\"h3\">{`Deploy all resources`}</strong></h3>\n    <ol>\n      <li parentName=\"ol\">{`Copy `}<inlineCode parentName=\"li\">{`terraform.tfvars.template`}</inlineCode>{` to `}<inlineCode parentName=\"li\">{`terraform.tfvars`}</inlineCode>{`:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`   cp terraform.tfvars.template terraform.tfvars\n`}</code></pre>\n    <ol {...{\n      \"start\": 2\n    }}>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Edit `}<inlineCode parentName=\"p\">{`terraform.tfvars`}</inlineCode>{` to match your environment.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"https://github.com/l2fprod/ibmcloud-ci\"\n          }}>{`following Docker image`}</a>{` to run the deployment scripts. It has all required tools preinstalled.`}</p>\n      </li>\n    </ol>\n    <ul>\n      <li parentName=\"ul\">{`On Linux terminal:`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{}}>{`   docker run -it --volume $PWD:/root/mnt/home --workdir /root/mnt/home l2fprod/ibmcloud-ci\n`}</code></pre>\n    <ul>\n      <li parentName=\"ul\">{`On Windows command prompt:`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{}}>{`   docker run -it --volume %CD%:/root/mnt/home --workdir /root/mnt/home l2fprod/ibmcloud-ci\n`}</code></pre>\n    <p>{`You can also try with your own environment. Prereqs are: tfswitch, terraform, ansible, ssh.`}</p>\n    <ol {...{\n      \"start\": 4\n    }}>\n      <li parentName=\"ol\">{`Run `}<inlineCode parentName=\"li\">{`tfswitch`}</inlineCode>{` to point to the right Terraform version for this solution:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{}}>{`   tfswitch\n`}</code></pre>\n    <ol {...{\n      \"start\": 5\n    }}>\n      <li parentName=\"ol\">{`Deploy all resources:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`   terraform init\n   terraform apply\n`}</code></pre>\n    <h3><strong parentName=\"h3\">{`Install OpenVPN on the bastion`}</strong></h3>\n    <ol>\n      <li parentName=\"ol\">{`Change to ansible directory:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{}}>{`   cd ansible\n`}</code></pre>\n    <ol {...{\n      \"start\": 2\n    }}>\n      <li parentName=\"ol\">{`Install ansible dependencies`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{}}>{`   ansible-galaxy install -r requirements.yml\n`}</code></pre>\n    <ol {...{\n      \"start\": 3\n    }}>\n      <li parentName=\"ol\">{`To confirm ansible configuration, ping all hosts`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{}}>{`   ansible all -m ping -i inventory -v\n`}</code></pre>\n    <ol {...{\n      \"start\": 4\n    }}>\n      <li parentName=\"ol\">{`Install OpenVPN on the bastion`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{}}>{`   ansible-playbook -i inventory playbook-openvpn.yml\n`}</code></pre>\n    <h3><strong parentName=\"h3\">{`Connect to OpenVPN`}</strong></h3>\n    <p>{`To connect to the VPN, use `}<em parentName=\"p\">{`OpenVPN Connects`}</em>{` with the configuration generated in `}<inlineCode parentName=\"p\">{`ansible/client-config/mymachine`}</inlineCode>{`:`}</p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://openvpn.net/client-connect-vpn-for-windows/\"\n        }}>{`https://openvpn.net/client-connect-vpn-for-windows/`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://openvpn.net/client-connect-vpn-for-mac-os/\"\n        }}>{`https://openvpn.net/client-connect-vpn-for-mac-os/`}</a></li>\n    </ul>\n    <p>{`or from a command line`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`   openvpn --setenv FORWARD_COMPATIBLE 1 --daemon --config ./client-config/mymachine/*-bastion.ovpn\n`}</code></pre>\n    <p>{`To view routes on macOS, use `}<inlineCode parentName=\"p\">{`netstat -nr`}</inlineCode>{`. On Linux and Windows `}<inlineCode parentName=\"p\">{`netstat -ar`}</inlineCode>{`.`}</p>\n    <h3><strong parentName=\"h3\">{`Test the OpenVPN connection`}</strong></h3>\n    <p>{`From the Docker container, ping one VPC server instance directly from your local machine:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`   ping $(terraform output -json | jq -r '.instance_ips.value[0]')\n`}</code></pre>\n    <p>{`or a COS direct endpoint:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`   ping s3.direct.us.cloud-object-storage.appdomain.cloud\n`}</code></pre>\n    <p>{`or a service private endpoint:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`   ping api.private.us-south.speech-to-text.watson.cloud.ibm.com\n`}</code></pre>\n    <p>{`If you stop the VPN connection, all these ping would fail.`}</p>\n    <h3><strong parentName=\"h3\">{`Destroy all configuration`}</strong></h3>\n    <ol>\n      <li parentName=\"ol\">{`To destroy the environment, from the Docker container use:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`   terraform destroy\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}